<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>LVHacks</title>

    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom fonts for this template -->
    <link href="https://fonts.googleapis.com/css?family=Catamaran:100,200,300,400,500,600,700,800,900" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Lato:100,100i,300,300i,400,400i,700,700i,900,900i"
          rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="stylesheets/style.css" rel="stylesheet">

</head>

<body onload="

FB.getLoginStatus(function(response) {
// The response object is returned with a status field that lets the
// app know the current login status of the person.
// Full docs on the response object can be found in the documentation
// for FB.getLoginStatus().
if (response.status === 'connected') {
// Logged into your app and Facebook.
    alert('Logged in');
    // $('.fb-login-button').hide();
    // $('#logoutButton').show();
    statusChangeCallback(response);
    console.log('Facebook getLoginStatus reached');
}
else {
// The person is not logged into your app or we are unable to tell.
FB.login(function(response) {

   console.log('login method itself: ' + response);
}, {scope: 'email'});
document.getElementById('status').innerHTML = 'Please log ' +
'into this app.';
}
}, {scope: 'user_likes'});"
>

<script>
    window.fbAsyncInit = function () {
        FB.init({
            appId: '187412542049724',
            cookie: true,
            xfbml: true,
            version: 'v2.12'
        });

        FB.AppEvents.logPageView();

    };

    (function (d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) {
            return;
        }
        js = d.createElement(s);
        js.id = id;
        js.src = "https://connect.facebook.net/en_US/sdk.js";
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));
</script>

<header class="masthead text-center text-white">
    <div class="masthead-content">
        <div class="container">
            <h1 class="masthead-heading mb-0">Showgestion</h1>
            <h2 class="masthead-subheading mb-0">You Like It. We Show it.</h2>
            <a href="#" class="btn btn-primary btn-primarybtn-xl rounded-pill mt-5" style="display:none;"
               id="logoutButton" onclick="FB.logout(function(response) {
  // user is now logged out
  console.log('logged out');
  $('#logoutButton').hide();
  $('.fb-login-button').show();
});">Log Out</a>
            <div class="fb-login-button" data-max-rows="1" data-size="large" data-button-type="continue_with"
                 data-show-faces="false" data-auto-logout-link="false" data-use-continue-as="false"
                 onlogin="checkLoginState();"></div>

        </div>
    </div>
    <div class="bg-circle-1 bg-circle"></div>
    <div class="bg-circle-2 bg-circle"></div>
    <div class="bg-circle-3 bg-circle"></div>
    <div class="bg-circle-4 bg-circle"></div>
</header>

<section>
    <div class="container" id="bottompart">

    </div>
</section>

<!-- Footer -->
<footer class="py-5 bg-black">
    <div class="container">
        <p class="m-0 text-center text-white small">Copyright &copy; Your Website 2018</p>
    </div>
    <!-- /.container -->
</footer>

<!-- Bootstrap core JavaScript -->
<script src="vendor/jquery/jquery.min.js"></script>
<script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<script>
    function scrollDown() {
        $('html, body').animate({
            scrollTop: $('#bottompart').offset().top
        }, 1000);
    }

    function statusChangeCallback(response) {
        console.log('statusChangeCallback');
        console.log(response);
        $('.fb-login-button').hide();
        $('#logoutButton').show();
        scrollDown();
        FB.login(function(response) {
            console.log(response);
        }, {    scope: 'user_likes'
        });
        FB.api(
            '/me',
            'GET',
            {"fields":"id,name,likes.limit(500)"},
            function(response) {
                console.log(response);
                var ids = new Array();
                if (response.likes != null) {
                    console.log("WE GOT THE LIKES");
                    let likesArray = response.likes.data;
                    // console.log('likesArray: ' + likesArray);
                    ids[0] = likesArray[0].id;
                    for (var i = 1; i < likesArray.length; i++) {
                        var likeId = likesArray[i].id;
                        var likeName = likesArray[i].name;
                        console.log(likeName + ' : ' + likeId);
                        ids[i] = likeId;
                    }
                    console.log(ids);
                    let data = "[\"302383559805193\", \"6049803276\", \"18510635068\", \"47923519017\", \"35649991492\", \"185019191542371\", \"313227042137369\", \"878737018959036\", \"523598997680162\", \"199617896754080\", \"117533210756\", \"112584912087017\", \"98102468683\"]";
                    var settings = {
                        "async": true,
                        "crossDomain": true,
                        "url": "https://cors-anywhere.herokuapp.com/https://api.applymagicsauce.com/like_ids?interpretations=true",
                        "method": "POST",
                        "headers": {
                            "X-Auth-Token": "sn0ed1isvb0768t9u0koh5vm2",
                            "Content-type": "application/json",
                            "Accept": "application/json",
                            "origin": "",
                            "Cache-Control": "no-cache",
                            "Postman-Token": "1a2bd93e-20e2-425d-97a6-6b9628067848"
                        },
                        "data": data
                    }
                    try {
                        $.ajax(settings).done(function (response) {
                            console.log("ERROR");
                            console.log(response);
                        });
                    }
                    catch (e) {
                        console.log(e);
                    }
                }
                else {
                    console.log("fuck this");
                }
            }
        );
    }

    // This function is called when someone finishes with the Login
    // Button.  See the onlogin handler attached to it in the sample
    // code below.
    function checkLoginState() {
        FB.getLoginStatus(function (response) {
            statusChangeCallback(response);
        });
    }
</script>
</body>


</html>
